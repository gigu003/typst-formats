library(canregtools)
library(ggcanreg)
library(ggplot2)
data <- canregs
#| width: 12
#| height: 12
#| layout-ncol: 2
areacodes <- show_registry(1:3)
areacodes <- areacodes[!areacodes=="410308"]
gg_map(areacodes)+theme_void()
gg_map(areacodes)+theme_void()
library(canregtools)
library(ggcanreg)
library(ggplot2)
library(dplyr)
data <- canregs
#| width: 12
#| height: 12
#| layout-ncol: 2
areacodes <- show_registry(1:3)
areacodes <- areacodes[!areacodes=="410308"]
gg_map(areacodes)+theme_void()
gg_map(areacodes)+theme_void()
?draw_barchart
asr <- create_asr(canregs[[1]], year, cancer)
data <- canregs[[1]]
rate <- create_asr(data, year, sex, cancer, event = "fbs")
draw_barchart(rate, plot_var = cr, cate_var = cancer, group_var = year,
side_var = year)
asr <- create_asr(canregs[[1]], year, cancer) |>
drop_others() |>
drop_total() |>
add_labels(label_type = "abbr")
draw_barchart(asr, plot_var = no_cases, cate_var = site, group_var = year,
side_var = year)
asr <- create_asr(canregs[[1]], year, cancer) |>
drop_others() |>
drop_total() |>
add_labels(label_type = "abbr")
draw_barchart(asr, plot_var = no_cases, cate_var = site, group_var = year)
asr <- create_asr(canregs[[1]], year, cancer) |>
drop_others() |>
drop_total() |>
add_labels(label_type = "abbr")
draw_barchart(asr, plot_var = no_cases, cate_var = site, group_var = year,
side_var = year,topn = 15)
asr <- create_asr(canregs[[1]], year, cancer) |>
drop_others() |>
drop_total() |>
add_labels(label_type = "abbr")
draw_barchart(asr, plot_var = no_cases, cate_var = site, group_var = year,
side_var = year,topn = 15, bar_side = 2)
?draw_bar
?draw_bar
asr1 <- create_asr(canregs[[1]], year, cancer) |>
drop_others() |>
drop_total() |>
add_labels(label_type = "abbr")
asr2 <- create_asr(canregs[[1]], year, cancer, event = "sws") |>
drop_others() |>
drop_total() |>
add_labels(label_type = "abbr")
View(asr1)
View(asr1)
asr1 <- create_asr(canregs[[1]], year, cancer) |>
drop_others() |>
drop_total() |>
add_labels(label_type = "abbr")
asr11 <- asr1 |> filter(cancer == cancer)
rank1 <- pull(asr11, rank)
case1 <- pull(asr11, no_cases)
rate1 <- pull(asr11, asr_cn2000)
rank1
cancer <- "110"
asr1 <- create_asr(canregs[[1]], year, cancer) |>
drop_others() |>
drop_total() |>
add_labels(label_type = "abbr")
asr11 <- asr1 |> filter(cancer == cancer)
asr11
View(asr11)
View(asr1)
asr1 <- create_asr(canregs[[1]], year, cancer) |>
drop_others() |>
drop_total() |>
add_labels(label_type = "abbr")
asr11 <- asr1 |> filter(cancer == "106")
rank1 <- pull(asr11, rank)
case1 <- pull(asr11, no_cases)
rate1 <- pull(asr11, asr_cn2000)
inci_text <- glue::glue("
#let inci-text = {{
text(size: 30pt)[发病情况]
linebreak()
grid(columns: (0.5em, 1fr, 1fr, 1fr),
text[],
align(center)[#text(size: 20pt)[顺位] \\ {rank1}],
align(center)[#text(size: 20pt)[发病数] \\ {case1}],
align(center)[#text(size: 20pt)[中标率] \\ {rate1}]
)
}}
")
asr2 <- create_asr(canregs[[1]], year, cancer, event = "sws") |>
drop_others() |>
drop_total() |>
add_labels(label_type = "abbr")
asr22 <- asr2 |> filter(cancer == cancer)
rank2 <- pull(asr22, rank)
case2 <- pull(asr22, no_cases)
rate2 <- pull(asr22, asr_cn2000)
mort_text <- glue::glue("
#let mort-text = {{
text(size: 30pt)[死亡情况]
linebreak()
grid(columns: (0.5em, 1fr, 1fr, 1fr),
text[],
align(center)[#text(size: 20pt)[顺位] \\ {rank2}],
align(center)[#text(size: 20pt)[发病数] \\ {case2}],
align(center)[#text(size: 20pt)[中标率] \\ {rate2}]
)
}}
")
rank1
case1
rate1
View(asr1)
library(canregtools)
library(dplyr)
library(glue)
cancer_code <- "110"
library(canregtools)
library(dplyr)
library(glue)
cancer_code <- "110"
asr1 <- create_asr(canregs[[1]], year, cancer) |>
drop_others() |>
drop_total() |>
add_labels(label_type = "abbr")
asr11 <- asr1 |> filter(cancer == cancer_code)
rank1 <- pull(asr11, rank)
case1 <- pull(asr11, no_cases)
rate1 <- pull(asr11, asr_cn2000)
inci_text <- glue::glue("
#let inci-text = {{
text(size: 30pt)[发病情况]
linebreak()
grid(columns: (0.5em, 1fr, 1fr, 1fr),
text[],
align(center)[#text(size: 20pt)[顺位] \\ {rank1}],
align(center)[#text(size: 20pt)[发病数] \\ {case1}],
align(center)[#text(size: 20pt)[中标率] \\ {rate1}]
)
}}
")
asr2 <- create_asr(canregs[[1]], year, cancer, event = "sws") |>
drop_others() |>
drop_total() |>
add_labels(label_type = "abbr")
asr22 <- asr2 |> filter(cancer == cancer)
rank2 <- pull(asr22, rank)
case2 <- pull(asr22, no_cases)
rate2 <- pull(asr22, asr_cn2000)
mort_text <- glue::glue("
#let mort-text = {{
text(size: 30pt)[死亡情况]
linebreak()
grid(columns: (0.5em, 1fr, 1fr, 1fr),
text[],
align(center)[#text(size: 20pt)[顺位] \\ {rank2}],
align(center)[#text(size: 20pt)[发病数] \\ {case2}],
align(center)[#text(size: 20pt)[中标率] \\ {rate2}]
)
}}
")
rank1
inci_text
mort_text
library(ggcanreg)
?gg_barchart
gg_barchart(asr1,cancer,no_cases)
gg_barchart(asr1,cancer,no_cases,highlight=110)
gg_barchart(asr1,cancer,no_cases,highlight=104)
gg_barchart(asr1,site,no_cases,highlight=104)
?barplot
#| fig-width: 8
#| fig-height: 5
barplot(c(1:5), col= "green")
library(canregtools)
library(manuscript)
library(dplyr)
library(glue)
cancer_code <- "106"
asr1 <- create_asr(canregs[[1]], cancer) |>
cr_filter(cancer == 110)
asr2 <- create_asr(canregs[[1]],cancer) |>
cr_filter(cancer == 110)
library(canregtools)
library(manuscript)
cancer_code <- "106"
asr_inci <- create_asr(canregs[[1]], sex, cancer)
asr_mort <- create_asr(canregs[[1]],sex, cancer, event = "sws")
#| output: asis
asr1 <- asr_inci |>
cr_filter(cancer == cancer_code, sex == 0)
asr2 <- asr_mort |>
cr_filter(cancer == cancer_code, sex == 0)
cr_summary_block(asr1, asr2, lang = "cn")
#| fig-width: 8
#| fig-height: 5
#| layout-ncol: 2
male <- asr_inci |>
cr_filter(sex == 1, drop = c("others", "total")) |>
add_labels()
draw_barchart(male, cancer_cn, cr)
?draw_barchart
#| fig-width: 8
#| fig-height: 5
#| layout-ncol: 2
male <- asr_inci |>
cr_filter(sex == 1, drop = c("others", "total")) |>
add_labels()
draw_barchart(male, cancer_cn, cr, y_label = "发病率-男性")
#| fig-width: 8
#| fig-height: 5
#| layout-ncol: 2
male <- asr_inci |>
cr_filter(sex == 1, drop = c("others", "total")) |>
add_labels()
draw_barchart(male, cancer_cn, cr, y_label = "发病率-男性", x_label_side = 2)
#| fig-width: 8
#| fig-height: 5
#| layout-ncol: 2
male <- asr_inci |>
cr_filter(sex == 1, drop = c("others", "total")) |>
add_labels()
draw_barchart(male, cancer_cn, cr, y_label = "发病率-男性", x_label_side = 2, bar_side = 2)
#| fig-width: 8
#| fig-height: 5
#| layout-ncol: 2
male <- asr_inci |>
cr_filter(sex == 1, drop = c("others", "total")) |>
add_labels()
draw_barchart(male, cancer_cn, cr, y_label = "发病率-男性", x_label_side = 1, bar_side = 2)
?draw_barchart
#| fig-width: 10
#| fig-height: 10
#| layout-ncol: 2
inci <- asr_inci |>
cr_filter(!sex == 0, drop = c("others", "total")) |>
add_labels(label_type = "abbr")
draw_barchart(inci, x = cancer_cn, y = cr, facet = sex_cn,
y_label = "发病率-男性",
x_label_side = 1,
bar_side = 2)
?draw_barchart
library(ggplot2)
#| fig-width: 6
#| fig-height: 4
#| layout-ncol: 2
inci <- asr_inci |>
cr_filter(!sex == 0, drop = c("others", "total")) |>
add_labels(label_type = "abbr")
#draw_barchart(inci, x = cancer_cn, y = cr, facet = sex_cn,
#              facet_label = c("发病率-男性（1/10万）", "发病率-女性（1/10万）"),
#              topn = 15
#              )
library(ggplot2)
theme_set(base_family = "STSong")
gg_barchart(inci,x = cancer_cn, y = cr, facet = sex_cn, ncol = 2, highlight = "肺")+
theme_grid()
?theme
cancer_code <- "106"
cancer_des <- tidy_var(cancer_code, var_name = "cancer", label_type = "abbr")
cancer_des
library(dplyr)
?element_text
